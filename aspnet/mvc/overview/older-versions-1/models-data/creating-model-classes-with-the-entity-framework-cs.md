---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: "Création de Classes de modèle avec Entity Framework (c#) | Documents Microsoft"
author: microsoft
description: "Dans ce didacticiel, vous allez apprendre à utiliser ASP.NET MVC avec Microsoft Entity Framework. Vous apprenez à utiliser l’Assistant pour créer un Da d’entité ADO.NET..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/27/2009
ms.topic: article
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 8a897f671de73d9991189e32a5d86b513051ef05
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/10/2017
---
<a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="1b24e-104">Création de Classes de modèle avec Entity Framework (c#)</span><span class="sxs-lookup"><span data-stu-id="1b24e-104">Creating Model Classes with the Entity Framework (C#)</span></span>
====================
<span data-ttu-id="1b24e-105">par [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="1b24e-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="1b24e-106">Dans ce didacticiel, vous allez apprendre à utiliser ASP.NET MVC avec Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="1b24e-107">Vous apprenez à utiliser l’Assistant pour créer un ADO.NET Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="1b24e-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="1b24e-108">Au cours de ce didacticiel, nous générer une application web qui montre comment sélectionner, insérer, mettre à jour et supprimer des données de la base de données à l’aide d’Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>


<span data-ttu-id="1b24e-109">L’objectif de ce didacticiel est d’expliquer comment vous pouvez créer des classes d’accès aux données à l’aide d’Entity Framework Microsoft lors de la création d’une application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="1b24e-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="1b24e-110">Ce didacticiel ne suppose aucune connaissance préalable de Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="1b24e-111">Avant la fin de ce didacticiel, vous allez apprendre à utiliser Entity Framework pour sélectionner, insérer, mettre à jour et supprimer des enregistrements de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="1b24e-112">Entity Framework Microsoft est un outil de mappage relationnel objet (O/RM) qui vous permet de générer une couche d’accès aux données à partir d’une base de données automatiquement.</span><span class="sxs-lookup"><span data-stu-id="1b24e-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="1b24e-113">Entity Framework vous permet de vous permet d’éviter le travail fastidieux de création de vos classes d’accès aux données manuellement.</span><span class="sxs-lookup"><span data-stu-id="1b24e-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="1b24e-114">Pour illustrer la façon dont vous pouvez utiliser Microsoft Entity Framework avec ASP.NET MVC, nous allons construire un exemple simple d’application.</span><span class="sxs-lookup"><span data-stu-id="1b24e-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="1b24e-115">Nous allons créer une application de base de données de film qui vous permet d’afficher et modifier des enregistrements de base de données de film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="1b24e-116">Ce didacticiel suppose que vous disposez de Visual Studio 2008 ou Visual Web Developer 2008 avec Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="1b24e-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="1b24e-117">Vous devez le Service Pack 1 pour pouvoir utiliser Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="1b24e-118">Vous pouvez télécharger Visual Studio 2008 Service Pack 1 ou Visual Web Developer, avec Service Pack 1 à partir de l’adresse suivante :</span><span class="sxs-lookup"><span data-stu-id="1b24e-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [<span data-ttu-id="1b24e-119">https://www.ASP.NET/downloads/</span><span class="sxs-lookup"><span data-stu-id="1b24e-119">https://www.asp.net/downloads/</span></span>](https://www.asp.net/downloads)


> [!NOTE] 
> 
> <span data-ttu-id="1b24e-120">Il n’existe aucune connexion essentielle entre ASP.NET MVC et Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-120">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="1b24e-121">Il existe plusieurs alternatives à Entity Framework que vous pouvez utiliser avec ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="1b24e-121">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="1b24e-122">Par exemple, vous pouvez générer vos classes de modèle MVC à l’aide d’autres outils O/RM telles que Microsoft LINQ to SQL, NHibernate ou SubSonic.</span><span class="sxs-lookup"><span data-stu-id="1b24e-122">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>


## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="1b24e-123">Création de la base de données vidéo</span><span class="sxs-lookup"><span data-stu-id="1b24e-123">Creating the Movie Sample Database</span></span>

<span data-ttu-id="1b24e-124">L’application de base de données de film utilise une table de base de données nommée films qui contient les colonnes suivantes :</span><span class="sxs-lookup"><span data-stu-id="1b24e-124">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="1b24e-125">Nom de la colonne</span><span class="sxs-lookup"><span data-stu-id="1b24e-125">Column Name</span></span> | <span data-ttu-id="1b24e-126">Type de données</span><span class="sxs-lookup"><span data-stu-id="1b24e-126">Data Type</span></span> | <span data-ttu-id="1b24e-127">Autoriser les valeurs null ?</span><span class="sxs-lookup"><span data-stu-id="1b24e-127">Allow Nulls?</span></span> | <span data-ttu-id="1b24e-128">Est la clé primaire ?</span><span class="sxs-lookup"><span data-stu-id="1b24e-128">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="1b24e-129">Id</span><span class="sxs-lookup"><span data-stu-id="1b24e-129">Id</span></span> | <span data-ttu-id="1b24e-130">int</span><span class="sxs-lookup"><span data-stu-id="1b24e-130">int</span></span> | <span data-ttu-id="1b24e-131">False</span><span class="sxs-lookup"><span data-stu-id="1b24e-131">False</span></span> | <span data-ttu-id="1b24e-132">True</span><span class="sxs-lookup"><span data-stu-id="1b24e-132">True</span></span> |
| <span data-ttu-id="1b24e-133">Titre</span><span class="sxs-lookup"><span data-stu-id="1b24e-133">Title</span></span> | <span data-ttu-id="1b24e-134">Nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="1b24e-134">nvarchar(100)</span></span> | <span data-ttu-id="1b24e-135">False</span><span class="sxs-lookup"><span data-stu-id="1b24e-135">False</span></span> | <span data-ttu-id="1b24e-136">False</span><span class="sxs-lookup"><span data-stu-id="1b24e-136">False</span></span> |
| <span data-ttu-id="1b24e-137">Directeur</span><span class="sxs-lookup"><span data-stu-id="1b24e-137">Director</span></span> | <span data-ttu-id="1b24e-138">Nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="1b24e-138">nvarchar(100)</span></span> | <span data-ttu-id="1b24e-139">False</span><span class="sxs-lookup"><span data-stu-id="1b24e-139">False</span></span> | <span data-ttu-id="1b24e-140">False</span><span class="sxs-lookup"><span data-stu-id="1b24e-140">False</span></span> |

<span data-ttu-id="1b24e-141">Vous pouvez ajouter cette table à un projet ASP.NET MVC en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="1b24e-141">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="1b24e-142">Avec le bouton droit de l’application\_dossier de données dans la fenêtre Explorateur de solutions et sélectionnez l’option de menu **ajouter, nouvel élément.**</span><span class="sxs-lookup"><span data-stu-id="1b24e-142">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="1b24e-143">À partir de la **ajouter un nouvel élément** boîte de dialogue, sélectionnez **base de données SQL Server**, donnez le nom MoviesDB.mdf à la base de données, puis cliquez sur le **ajouter** bouton.</span><span class="sxs-lookup"><span data-stu-id="1b24e-143">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="1b24e-144">Double-cliquez sur le fichier MoviesDB.mdf pour ouvrir la fenêtre de l’Explorateur de serveurs/base de données de l’Explorateur.</span><span class="sxs-lookup"><span data-stu-id="1b24e-144">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="1b24e-145">Développez la connexion de base de données MoviesDB.mdf, cliquez sur le dossier Tables et sélectionnez l’option de menu **ajouter une nouvelle Table**.</span><span class="sxs-lookup"><span data-stu-id="1b24e-145">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="1b24e-146">Dans le Concepteur de tables, ajoutez les colonnes Id, Title et directeur.</span><span class="sxs-lookup"><span data-stu-id="1b24e-146">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="1b24e-147">Cliquez sur le **enregistrer** bouton (elle possède l’icône de disquette) pour enregistrer la nouvelle table avec les nom de films.</span><span class="sxs-lookup"><span data-stu-id="1b24e-147">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="1b24e-148">Après avoir créé la table de base de données de films, vous devez ajouter quelques exemples de données à la table.</span><span class="sxs-lookup"><span data-stu-id="1b24e-148">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="1b24e-149">Avec le bouton droit de la table de films et sélectionnez l’option de menu **afficher les données de Table**.</span><span class="sxs-lookup"><span data-stu-id="1b24e-149">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="1b24e-150">Vous pouvez entrer des données vidéo fausse dans la grille qui s’affiche.</span><span class="sxs-lookup"><span data-stu-id="1b24e-150">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="1b24e-151">Création de l’ADO.NET Entity Data Model</span><span class="sxs-lookup"><span data-stu-id="1b24e-151">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="1b24e-152">Pour pouvoir utiliser Entity Framework, vous devez créer un Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="1b24e-152">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="1b24e-153">Vous pouvez tirer parti de Visual Studio *Assistant Entity Data Model* pour générer un Entity Data Model à partir d’une base de données automatiquement.</span><span class="sxs-lookup"><span data-stu-id="1b24e-153">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="1b24e-154">Procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="1b24e-154">Follow these steps:</span></span>

1. <span data-ttu-id="1b24e-155">Cliquez sur le dossier Modèles dans la fenêtre de l’Explorateur de solutions et sélectionnez l’option de menu **ajouter, nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="1b24e-155">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="1b24e-156">Dans le **ajouter un nouvel élément** boîte de dialogue, sélectionnez la catégorie de données (voir Figure 1).</span><span class="sxs-lookup"><span data-stu-id="1b24e-156">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="1b24e-157">Sélectionnez le **ADO.NET Entity Data Model** modèle, donnez le nom MoviesDBModel.edmx à l’Entity Data Model, puis cliquez sur le **ajouter** bouton.</span><span class="sxs-lookup"><span data-stu-id="1b24e-157">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="1b24e-158">En cliquant sur le **ajouter** bouton lance l’Assistant de modèle de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-158">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="1b24e-159">Dans le **choisir le contenu du modèle** pas à pas, choisissez la **générer à partir d’une base de données** , puis cliquez sur le **suivant** bouton (voir Figure 2).</span><span class="sxs-lookup"><span data-stu-id="1b24e-159">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="1b24e-160">Dans le **choisir votre connexion de données** étape, sélectionnez la connexion de base de données MoviesDB.mdf, entrez les entités de paramètres de connexion nom MoviesDBEntities, puis cliquez sur le **suivant** bouton (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="1b24e-160">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="1b24e-161">Dans le **choisir vos objets de base de données** pas à pas, sélectionnez la table de base de données de film, cliquez sur le **Terminer** bouton (voir Figure 4).</span><span class="sxs-lookup"><span data-stu-id="1b24e-161">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="1b24e-162">Après avoir effectué ces étapes, ADO.NET Entity Data Model Designer (Concepteur d’entités) s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="1b24e-162">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="1b24e-163">**Figure 1 : création d’un nouveau modèle de données d’entité**</span><span class="sxs-lookup"><span data-stu-id="1b24e-163">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="1b24e-165">**Figure 2 : choisissez l’étape de contenu de modèle**</span><span class="sxs-lookup"><span data-stu-id="1b24e-165">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="1b24e-167">**Figure 3 : choisir votre connexion de données**</span><span class="sxs-lookup"><span data-stu-id="1b24e-167">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="1b24e-169">**Figure 4 – choisir vos objets de base de données**</span><span class="sxs-lookup"><span data-stu-id="1b24e-169">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="1b24e-171">Modification de l’ADO.NET Entity Data Model</span><span class="sxs-lookup"><span data-stu-id="1b24e-171">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="1b24e-172">Après avoir créé un Entity Data Model, vous pouvez modifier le modèle en tirant parti du Concepteur d’entités (voir Figure 5).</span><span class="sxs-lookup"><span data-stu-id="1b24e-172">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="1b24e-173">Vous pouvez ouvrir le Concepteur d’entités à tout moment en double-cliquant sur le fichier MoviesDBModel.edmx contenu dans le dossier de modèles dans la fenêtre de l’Explorateur de solutions.</span><span class="sxs-lookup"><span data-stu-id="1b24e-173">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="1b24e-174">**Figure 5 – l’ADO.NET Entity Data Model Designer**</span><span class="sxs-lookup"><span data-stu-id="1b24e-174">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="1b24e-176">Par exemple, vous pouvez utiliser le Concepteur d’entités pour modifier les noms des classes de l’Assistant modèle génère.</span><span class="sxs-lookup"><span data-stu-id="1b24e-176">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="1b24e-177">L’Assistant a créé une nouvelle classe d’accès aux données nommée films.</span><span class="sxs-lookup"><span data-stu-id="1b24e-177">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="1b24e-178">En d’autres termes, l’Assistant a le même nom que la table de base de données à la classe.</span><span class="sxs-lookup"><span data-stu-id="1b24e-178">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="1b24e-179">Étant donné que nous utiliserons cette classe pour représenter une instance particulière de film, nous devons renommez la classe à partir de films film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-179">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="1b24e-180">Si vous souhaitez renommer une classe d’entité, vous pouvez double-cliquer sur le nom de classe dans le Concepteur d’entités et entrez un nouveau nom (voir Figure 6).</span><span class="sxs-lookup"><span data-stu-id="1b24e-180">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="1b24e-181">Ou bien, vous pouvez modifier le nom d’une entité dans la fenêtre Propriétés après avoir sélectionné une entité dans le Concepteur d’entités.</span><span class="sxs-lookup"><span data-stu-id="1b24e-181">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="1b24e-182">**Figure 6 : modification du nom d’une entité**</span><span class="sxs-lookup"><span data-stu-id="1b24e-182">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="1b24e-184">Pensez à enregistrer votre Entity Data Model après avoir apporté une modification en cliquant sur le bouton Enregistrer (l’icône de la disquette).</span><span class="sxs-lookup"><span data-stu-id="1b24e-184">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="1b24e-185">En arrière-plan, le Concepteur d’entités génère un ensemble de classes c#.</span><span class="sxs-lookup"><span data-stu-id="1b24e-185">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="1b24e-186">Vous pouvez afficher ces classes en ouvrant le fichier MoviesDBModel.Designer.cs à partir de la fenêtre de l’Explorateur de solutions.</span><span class="sxs-lookup"><span data-stu-id="1b24e-186">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>


<span data-ttu-id="1b24e-187">Ne modifiez pas le code dans le fichier Designer.cs depuis vos modifications seront remplacées la prochaine fois que vous utilisez le Concepteur d’entités.</span><span class="sxs-lookup"><span data-stu-id="1b24e-187">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="1b24e-188">Si vous souhaitez étendre les fonctionnalités des classes d’entité défini dans le fichier Designer.cs, vous pouvez créer *classes partielles* dans des fichiers distincts.</span><span class="sxs-lookup"><span data-stu-id="1b24e-188">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>


#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="1b24e-189">Sélectionner des enregistrements de base de données avec Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1b24e-189">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="1b24e-190">Nous allons commencer la création de notre application de base de données de film en créant une page qui affiche une liste d’enregistrements de film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-190">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="1b24e-191">Le contrôleur Home dans la liste 1 expose une action nommée Index().</span><span class="sxs-lookup"><span data-stu-id="1b24e-191">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="1b24e-192">L’action Index() retourne tous les enregistrements de films à partir de la table de base de données de film en tirant parti d’Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-192">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="1b24e-193">**La liste 1 – Controllers\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="1b24e-193">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="1b24e-194">Notez que le contrôleur dans la liste 1 comprend un constructeur.</span><span class="sxs-lookup"><span data-stu-id="1b24e-194">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="1b24e-195">Le constructeur initialise un champ de niveau classe nommé \_db.</span><span class="sxs-lookup"><span data-stu-id="1b24e-195">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="1b24e-196">Le \_champ de base de données représente les entités de base de données générées par Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-196">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="1b24e-197">Le \_champ de base de données est une instance de la classe MoviesDBEntities qui a été générée par le Concepteur d’entités.</span><span class="sxs-lookup"><span data-stu-id="1b24e-197">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>


<span data-ttu-id="1b24e-198">Pour pouvoir utiliser theMoviesDBEntities classe dans le contrôleur Home, vous devez importer l’espace de noms MovieEntityApp.Models (*MVCProjectName*. Modèles).</span><span class="sxs-lookup"><span data-stu-id="1b24e-198">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>


<span data-ttu-id="1b24e-199">Le \_champ de base de données est utilisé au sein de l’action Index() pour récupérer les enregistrements de la table de base de données de films.</span><span class="sxs-lookup"><span data-stu-id="1b24e-199">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="1b24e-200">L’expression \_db. MovieSet représente tous les enregistrements de la table de base de données de films.</span><span class="sxs-lookup"><span data-stu-id="1b24e-200">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="1b24e-201">La méthode ToList() est utilisée pour convertir le jeu de films dans une collection générique d’objets de film (liste&lt;film&gt;).</span><span class="sxs-lookup"><span data-stu-id="1b24e-201">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="1b24e-202">Les enregistrements de film sont récupérés à l’aide de LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="1b24e-202">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="1b24e-203">L’action Index() dans la liste 1 utilise LINQ *syntaxe de la méthode* pour récupérer le jeu d’enregistrements de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-203">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="1b24e-204">Si vous préférez, vous pouvez utiliser LINQ *syntaxe de requête* à la place.</span><span class="sxs-lookup"><span data-stu-id="1b24e-204">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="1b24e-205">Les deux instructions suivantes effectuent la même chose :</span><span class="sxs-lookup"><span data-stu-id="1b24e-205">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="1b24e-206">Utiliser quelle que soit la syntaxe LINQ, syntaxe de méthode ou une syntaxe de requête, que vous trouvez plus intuitive.</span><span class="sxs-lookup"><span data-stu-id="1b24e-206">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="1b24e-207">Il n’existe aucune différence de performances entre les deux méthodes : la seule différence est le style.</span><span class="sxs-lookup"><span data-stu-id="1b24e-207">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="1b24e-208">La vue dans la liste 2 est utilisée pour afficher les enregistrements de film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-208">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="1b24e-209">**Listing 2 – Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="1b24e-209">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="1b24e-210">La vue de liste 2 contient un **foreach** boucle qui effectue une itération dans chaque enregistrement vidéo et affiche les valeurs des propriétés du titre et le directeur de l’enregistrement vidéo.</span><span class="sxs-lookup"><span data-stu-id="1b24e-210">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="1b24e-211">Notez qu’un lien d’édition et de suppression s’affiche en regard de chaque enregistrement.</span><span class="sxs-lookup"><span data-stu-id="1b24e-211">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="1b24e-212">En outre, un lien Ajouter un film apparaît au bas de la vue (voir la Figure 7).</span><span class="sxs-lookup"><span data-stu-id="1b24e-212">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="1b24e-213">**Figure 7 – la vue Index**</span><span class="sxs-lookup"><span data-stu-id="1b24e-213">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="1b24e-215">La vue de l’Index est un *typée vue*.</span><span class="sxs-lookup"><span data-stu-id="1b24e-215">The Index view is a *typed view*.</span></span> <span data-ttu-id="1b24e-216">La vue Index inclut un &lt;% @ Page %&gt; directive avec un *Inherits* attribut qui effectue un cast de la propriété de modèle à une collection de liste générique fortement typée d’objets de film (liste&lt;film).</span><span class="sxs-lookup"><span data-stu-id="1b24e-216">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="1b24e-217">Insertion d’enregistrements de base de données avec Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1b24e-217">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="1b24e-218">Vous pouvez utiliser Entity Framework pour faciliter l’insérer de nouveaux enregistrements dans une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-218">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="1b24e-219">La liste 3 contient deux nouvelles actions ajoutées à la classe de contrôleur d’accueil que vous pouvez utiliser pour insérer de nouveaux enregistrements dans la table de base de données de film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-219">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="1b24e-220">**La liste 3 – Controllers\HomeController.cs (ajouter des méthodes)**</span><span class="sxs-lookup"><span data-stu-id="1b24e-220">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="1b24e-221">La première action Add() retourne simplement une vue.</span><span class="sxs-lookup"><span data-stu-id="1b24e-221">The first Add() action simply returns a view.</span></span> <span data-ttu-id="1b24e-222">La vue contient un formulaire pour ajouter une nouvelle base de données de film enregistrer (voir la Figure 8).</span><span class="sxs-lookup"><span data-stu-id="1b24e-222">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="1b24e-223">Quand vous envoyez le formulaire, la seconde action Add() est appelée.</span><span class="sxs-lookup"><span data-stu-id="1b24e-223">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="1b24e-224">Notez que la seconde action Add() est décorée avec l’attribut AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="1b24e-224">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="1b24e-225">Cette action peut être appelée uniquement lorsque vous effectuez une opération HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="1b24e-225">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="1b24e-226">En d’autres termes, cette action peut uniquement être appelée lors de la validation d’un formulaire HTML.</span><span class="sxs-lookup"><span data-stu-id="1b24e-226">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="1b24e-227">La seconde action Add() crée une nouvelle instance de la classe Entity Framework film à l’aide de la méthode ASP.NET MVC TryUpdateModel().</span><span class="sxs-lookup"><span data-stu-id="1b24e-227">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="1b24e-228">La méthode TryUpdateModel() prend les champs dans la FormCollection passé à la méthode Add() et assigne les valeurs de ces champs de formulaire HTML à la classe de film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-228">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>


<span data-ttu-id="1b24e-229">Lorsque vous utilisez Entity Framework, vous devez fournir une « liste blanche » des propriétés lorsque vous utilisez les méthodes TryUpdateModel ou UpdateModel pour mettre à jour les propriétés d’une classe d’entité.</span><span class="sxs-lookup"><span data-stu-id="1b24e-229">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>


<span data-ttu-id="1b24e-230">Ensuite, l’action Add() effectue une validation de formulaire simple.</span><span class="sxs-lookup"><span data-stu-id="1b24e-230">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="1b24e-231">L’action vérifie que le titre et le directeur des propriétés ont des valeurs.</span><span class="sxs-lookup"><span data-stu-id="1b24e-231">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="1b24e-232">S’il existe une erreur de validation, un message d’erreur de validation est ajouté à ModelState.</span><span class="sxs-lookup"><span data-stu-id="1b24e-232">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="1b24e-233">S’il n’y a aucune erreur de validation un nouvel enregistrement de film est ajouté à la table de base de données de films à l’aide d’Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-233">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="1b24e-234">Le nouvel enregistrement est ajouté à la base de données avec les deux lignes de code suivantes :</span><span class="sxs-lookup"><span data-stu-id="1b24e-234">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="1b24e-235">La première ligne de code ajoute la nouvelle entité de film à l’ensemble de films suivies par Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-235">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="1b24e-236">La deuxième ligne de code enregistre toutes les modifications ont été apportées pour les films suivies à la base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="1b24e-236">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="1b24e-237">**Figure 8 : la vue de l’ajouter**</span><span class="sxs-lookup"><span data-stu-id="1b24e-237">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="1b24e-239">Mise à jour des enregistrements de base de données avec Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1b24e-239">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="1b24e-240">Vous pouvez suivre pratiquement la même approche pour modifier un enregistrement de base de données avec Entity Framework en tant que l’approche que nous avons simplement suivies pour insérer un nouvel enregistrement de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-240">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="1b24e-241">La liste 4 contient deux nouvelles actions de contrôleur nommées Edit().</span><span class="sxs-lookup"><span data-stu-id="1b24e-241">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="1b24e-242">La première action Edit() retourne un formulaire HTML pour la modification d’un enregistrement vidéo.</span><span class="sxs-lookup"><span data-stu-id="1b24e-242">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="1b24e-243">La seconde action Edit() tente de mettre à jour la base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-243">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="1b24e-244">**La liste 4 – Controllers\HomeController.cs (méthodes de modification)**</span><span class="sxs-lookup"><span data-stu-id="1b24e-244">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="1b24e-245">La seconde action Edit() commence par récupérer de l’enregistrement vidéo à partir de la base de données qui correspond à l’Id de la séquence en cours de modification.</span><span class="sxs-lookup"><span data-stu-id="1b24e-245">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="1b24e-246">LINQ to instruction d’entités suivants extrait le premier enregistrement de base de données qui correspond à un Id spécifique :</span><span class="sxs-lookup"><span data-stu-id="1b24e-246">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="1b24e-247">Ensuite, la méthode TryUpdateModel() est utilisée pour affecter les valeurs des champs de formulaire HTML pour les propriétés de l’entité de film.</span><span class="sxs-lookup"><span data-stu-id="1b24e-247">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="1b24e-248">Notez qu’une liste blanche est fournie pour spécifier les propriétés exactes à mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="1b24e-248">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="1b24e-249">Ensuite, une validation simple est exécutée pour vérifier que le titre du film et le directeur des propriétés ont des valeurs.</span><span class="sxs-lookup"><span data-stu-id="1b24e-249">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="1b24e-250">Si une valeur sont manquante dans des propriétés, puis un message d’erreur de validation est ajouté à ModelState et ModelState.IsValid renvoie la valeur false.</span><span class="sxs-lookup"><span data-stu-id="1b24e-250">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="1b24e-251">Enfin, s’il n’y a aucune erreur de validation, la table de base de données de films sous-jacent est mises à jour en appelant la méthode SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="1b24e-251">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="1b24e-252">Lors de la modification des enregistrements de base de données, vous devez passer l’Id de l’enregistrement en cours de modification pour l’action du contrôleur qui effectue la mise à jour de la base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-252">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="1b24e-253">Sinon, l’action du contrôleur ne saura pas quel enregistrement il doit mettre à jour dans la base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="1b24e-253">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="1b24e-254">La vue de modification contenue dans la liste 5, inclut un champ masqué qui représente l’Id de l’enregistrement de base de données en cours de modification.</span><span class="sxs-lookup"><span data-stu-id="1b24e-254">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="1b24e-255">**La liste 5 – Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="1b24e-255">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="1b24e-256">Suppression d’enregistrements de base de données avec Entity Framework</span><span class="sxs-lookup"><span data-stu-id="1b24e-256">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="1b24e-257">L’opération finale de la base de données, nous avons besoin d’attaquer dans ce didacticiel, supprime les enregistrements de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-257">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="1b24e-258">Vous pouvez utiliser l’action du contrôleur dans la liste 6 pour supprimer un enregistrement de base de données particulière.</span><span class="sxs-lookup"><span data-stu-id="1b24e-258">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="1b24e-259">**La liste 6--\Controllers\HomeController.cs (action de suppression)**</span><span class="sxs-lookup"><span data-stu-id="1b24e-259">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="1b24e-260">L’action Delete() récupère d’abord le film entité qui correspond à l’Id est transmise à l’action.</span><span class="sxs-lookup"><span data-stu-id="1b24e-260">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="1b24e-261">Ensuite, la séquence est supprimée de la base de données en appelant la méthode DeleteObject() suivie par la méthode SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="1b24e-261">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="1b24e-262">Enfin, l’utilisateur est redirigé vers la vue Index.</span><span class="sxs-lookup"><span data-stu-id="1b24e-262">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="1b24e-263">Résumé</span><span class="sxs-lookup"><span data-stu-id="1b24e-263">Summary</span></span>

<span data-ttu-id="1b24e-264">L’objectif de ce didacticiel a pour illustrer comment vous pouvez générer des applications web orientées sur la base de données en tirant parti d’ASP.NET MVC et Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1b24e-264">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="1b24e-265">Vous avez appris à créer une application qui vous permet de sélectionner, insérer, mettre à jour et supprimer des enregistrements de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-265">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="1b24e-266">Tout d’abord, nous avons expliqué comment vous pouvez utiliser l’Assistant Entity Data Model pour générer un Entity Data Model à partir de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1b24e-266">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="1b24e-267">Ensuite, vous découvrez comment utiliser LINQ to Entities pour récupérer un jeu d’enregistrements de base de données à partir d’une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-267">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="1b24e-268">Enfin, nous avons utilisé l’Entity Framework pour insérer, mettre à jour et supprimer des enregistrements de base de données.</span><span class="sxs-lookup"><span data-stu-id="1b24e-268">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="1b24e-269">Next</span><span class="sxs-lookup"><span data-stu-id="1b24e-269">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)
