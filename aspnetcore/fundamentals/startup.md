---
title: "Démarrage de l’application dans ASP.NET Core"
author: ardalis
description: "Explique la classe de démarrage dans ASP.NET Core."
keywords: "ASP.NET Core, démarrage, méthode Configure, ConfigureServices (méthode)"
ms.author: tdykstra
manager: wpickett
ms.date: 02/29/2017
ms.topic: article
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/startup
ms.openlocfilehash: 16969386c55ae2fd2ab574c1799a765e74f59278
ms.sourcegitcommit: 4147d2d29ea50e7e9b87879c572ac2a9fb51798c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/15/2017
---
# <a name="application-startup-in-aspnet-core"></a><span data-ttu-id="054ac-104">Démarrage de l’application dans ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="054ac-104">Application Startup in ASP.NET Core</span></span>

<span data-ttu-id="054ac-105">Par [Steve Smith](http://ardalis.com) et [Tom Dykstra](https://github.com/tdykstra/)</span><span class="sxs-lookup"><span data-stu-id="054ac-105">By [Steve Smith](http://ardalis.com) and [Tom Dykstra](https://github.com/tdykstra/)</span></span>

<span data-ttu-id="054ac-106">La `Startup` classe configure les services et le pipeline de demande de l’application.</span><span class="sxs-lookup"><span data-stu-id="054ac-106">The `Startup` class configures services and the application's request pipeline.</span></span> 

## <a name="the-startup-class"></a><span data-ttu-id="054ac-107">Classe de démarrage.</span><span class="sxs-lookup"><span data-stu-id="054ac-107">The Startup class</span></span>

<span data-ttu-id="054ac-108">Les applications ASP.NET Core nécessitent un `Startup` classe.</span><span class="sxs-lookup"><span data-stu-id="054ac-108">ASP.NET Core apps require a `Startup` class.</span></span> <span data-ttu-id="054ac-109">Par convention, le `Startup` classe est nommée « Démarrage ».</span><span class="sxs-lookup"><span data-stu-id="054ac-109">By convention, the `Startup` class is named "Startup".</span></span> <span data-ttu-id="054ac-110">Vous spécifiez le nom de classe de démarrage dans le `Main` du programme [WebHostBuilderExtensions](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions) [ `UseStartup<TStartup>` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions#Microsoft_AspNetCore_Hosting_WebHostBuilderExtensions_UseStartup__1_Microsoft_AspNetCore_Hosting_IWebHostBuilder_) (méthode).</span><span class="sxs-lookup"><span data-stu-id="054ac-110">You specify the startup class name in the `Main` program's [WebHostBuilderExtensions](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions) [`UseStartup<TStartup>`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions#Microsoft_AspNetCore_Hosting_WebHostBuilderExtensions_UseStartup__1_Microsoft_AspNetCore_Hosting_IWebHostBuilder_) method.</span></span> <span data-ttu-id="054ac-111">Consultez [hébergement](xref:fundamentals/hosting) pour en savoir plus sur `WebHostBuilder`, qui s’exécute avant `Startup`.</span><span class="sxs-lookup"><span data-stu-id="054ac-111">See [Hosting](xref:fundamentals/hosting) to learn more about `WebHostBuilder`, which runs before `Startup`.</span></span>

<span data-ttu-id="054ac-112">Vous pouvez définir distinct `Startup` classes pour les différents environnements et appropriées, un est sélectionné lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="054ac-112">You can define separate `Startup` classes for different environments, and the appropriate one will be selected at runtime.</span></span> <span data-ttu-id="054ac-113">Si vous spécifiez `startupAssembly` dans les [WebHost configuration](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#configuring-a-host) ou options d’hébergement charge cet assembly de démarrage et recherchez un `Startup` ou `Startup[Environment]` type.</span><span class="sxs-lookup"><span data-stu-id="054ac-113">If you specify `startupAssembly` in the [WebHost configuration](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#configuring-a-host) or options, hosting will load that startup assembly and search for a `Startup` or `Startup[Environment]` type.</span></span> <span data-ttu-id="054ac-114">La classe dont suffixe de nom correspond à l’environnement actuel est prioritaires, par conséquent, si l’application est exécutée dans le *développement* environnement et comprend à la fois un `Startup` et un `StartupDevelopment` (classe), la `StartupDevelopment` classe sera utilisé.</span><span class="sxs-lookup"><span data-stu-id="054ac-114">The class whose name suffix matches the current environment will be prioritized, so if the app is run in the *Development* environment, and includes both a `Startup` and a `StartupDevelopment` class, the `StartupDevelopment` class will be used.</span></span> <span data-ttu-id="054ac-115">Consultez [FindStartupType](https://github.com/aspnet/Hosting/blob/rel/1.1.0/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs) dans `StartupLoader` et [fonctionne avec plusieurs environnements](environments.md#startup-conventions).</span><span class="sxs-lookup"><span data-stu-id="054ac-115">See [FindStartupType](https://github.com/aspnet/Hosting/blob/rel/1.1.0/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs) in `StartupLoader` and [Working with multiple environments](environments.md#startup-conventions).</span></span>

<span data-ttu-id="054ac-116">Vous pouvez également définir un fixe `Startup` classe qui sera utilisé, quelle que soit l’environnement en appelant `UseStartup<TStartup>`.</span><span class="sxs-lookup"><span data-stu-id="054ac-116">Alternatively, you can define a fixed `Startup` class that will be used regardless of the environment by calling `UseStartup<TStartup>`.</span></span> <span data-ttu-id="054ac-117">Il s'agit de l'approche recommandée.</span><span class="sxs-lookup"><span data-stu-id="054ac-117">This is the recommended approach.</span></span>

<span data-ttu-id="054ac-118">Le `Startup` constructeur de classe peut accepter des dépendances qui sont fournies via [injection de dépendance](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="054ac-118">The `Startup` class constructor can accept dependencies that are provided through [dependency injection](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="054ac-119">Une approche courante consiste à utiliser `IHostingEnvironment` configurer [configuration](xref:fundamentals/configuration) sources.</span><span class="sxs-lookup"><span data-stu-id="054ac-119">A common approach is to use `IHostingEnvironment` to set up [configuration](xref:fundamentals/configuration) sources.</span></span>

<span data-ttu-id="054ac-120">Le `Startup` doit inclure un `Configure` (méthode) et peut éventuellement inclure un `ConfigureServices` méthode, qui sont appelées lorsque l’application démarre.</span><span class="sxs-lookup"><span data-stu-id="054ac-120">The `Startup` class must include a `Configure` method and can optionally include a `ConfigureServices` method, both of which are called when the application starts.</span></span> <span data-ttu-id="054ac-121">La classe peut également inclure [versions spécifiques à l’environnement de ces méthodes](xref:fundamentals/environments#startup-conventions).</span><span class="sxs-lookup"><span data-stu-id="054ac-121">The class can also include [environment-specific versions of these methods](xref:fundamentals/environments#startup-conventions).</span></span> <span data-ttu-id="054ac-122">`ConfigureServices`, le cas échéant, est appelée avant `Configure`.</span><span class="sxs-lookup"><span data-stu-id="054ac-122">`ConfigureServices`, if present, is called before `Configure`.</span></span>

<span data-ttu-id="054ac-123">En savoir plus sur [la gestion des exceptions au cours du démarrage de l’application](xref:fundamentals/error-handling#startup-exception-handling).</span><span class="sxs-lookup"><span data-stu-id="054ac-123">Learn about [handling exceptions during application startup](xref:fundamentals/error-handling#startup-exception-handling).</span></span>

## <a name="the-configureservices-method"></a><span data-ttu-id="054ac-124">La méthode ConfigureServices</span><span class="sxs-lookup"><span data-stu-id="054ac-124">The ConfigureServices method</span></span>

<span data-ttu-id="054ac-125">Le [ConfigureServices](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.hosting.startupbase#Microsoft_AspNetCore_Hosting_StartupBase_ConfigureServices_Microsoft_Extensions_DependencyInjection_IServiceCollection_) méthode est facultative ; mais si utilisée, elle est appelée avant la `Configure` méthode par l’hôte web.</span><span class="sxs-lookup"><span data-stu-id="054ac-125">The [ConfigureServices](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.hosting.startupbase#Microsoft_AspNetCore_Hosting_StartupBase_ConfigureServices_Microsoft_Extensions_DependencyInjection_IServiceCollection_) method is optional; but if used, it's called before the `Configure` method by the web host.</span></span> <span data-ttu-id="054ac-126">L’hôte web peut configurer certains services avant ``Startup`` méthodes sont appelées (voir [hébergement](xref:fundamentals/hosting)).</span><span class="sxs-lookup"><span data-stu-id="054ac-126">The web host may configure some services before ``Startup`` methods are called (see [hosting](xref:fundamentals/hosting)).</span></span> <span data-ttu-id="054ac-127">Par convention, [les options de Configuration](xref:fundamentals/configuration) sont définies dans cette méthode.</span><span class="sxs-lookup"><span data-stu-id="054ac-127">By convention, [Configuration options](xref:fundamentals/configuration) are set in this method.</span></span>

<span data-ttu-id="054ac-128">Pour les fonctionnalités qui nécessitent le programme d’installation importante sont `Add[Service]` méthodes d’extension sur [IServiceCollection](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.extensions.dependencyinjection.iservicecollection).</span><span class="sxs-lookup"><span data-stu-id="054ac-128">For features that require substantial setup there are `Add[Service]` extension methods on [IServiceCollection](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.extensions.dependencyinjection.iservicecollection).</span></span> <span data-ttu-id="054ac-129">Cet exemple à partir du modèle de site web par défaut configure l’application pour utiliser les services pour Entity Framework, d’identité et MVC :</span><span class="sxs-lookup"><span data-stu-id="054ac-129">This example from the default web site template configures the app to use services for Entity Framework, Identity, and MVC:</span></span>

<span data-ttu-id="054ac-130">[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=4,7,11&start=40&end=55)]</span><span class="sxs-lookup"><span data-stu-id="054ac-130">[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=4,7,11&start=40&end=55)]</span></span>

<span data-ttu-id="054ac-131">Ajout de services au conteneur de services les rend disponibles dans votre application via [injection de dépendance](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="054ac-131">Adding services to the services container makes them available within your application via [dependency injection](xref:fundamentals/dependency-injection).</span></span>

## <a name="services-available-in-startup"></a><span data-ttu-id="054ac-132">Services disponibles dans le démarrage</span><span class="sxs-lookup"><span data-stu-id="054ac-132">Services Available in Startup</span></span>

<span data-ttu-id="054ac-133">Injection de dépendances ASP.NET Core fournit des services lors du démarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="054ac-133">ASP.NET Core dependency injection provides services during an application's startup.</span></span> <span data-ttu-id="054ac-134">Vous pouvez demander ces services en incluant l’interface appropriée en tant que paramètre sur votre `Startup` constructeur de la classe ou son `Configure` (méthode).</span><span class="sxs-lookup"><span data-stu-id="054ac-134">You can request these services by including the appropriate interface as a parameter on your `Startup` class's constructor or its `Configure` method.</span></span> <span data-ttu-id="054ac-135">Le `ConfigureServices` méthode n’accepte qu’un `IServiceCollection` paramètre (mais n’importe quel service inscrit peut en être récupérés à partir de cette collection, des paramètres supplémentaires ne sont pas nécessaires).</span><span class="sxs-lookup"><span data-stu-id="054ac-135">The `ConfigureServices` method only takes an `IServiceCollection` parameter (but any registered service can be retrieved from this collection, so additional parameters are not necessary).</span></span>

<span data-ttu-id="054ac-136">Voici quelques-unes des services en général demandées par `Startup` méthodes :</span><span class="sxs-lookup"><span data-stu-id="054ac-136">Below are some of the services typically requested by `Startup` methods:</span></span>

* <span data-ttu-id="054ac-137">Dans le constructeur : `IHostingEnvironment`,`ILogger<Startup>`</span><span class="sxs-lookup"><span data-stu-id="054ac-137">In the constructor:  `IHostingEnvironment`, `ILogger<Startup>`</span></span>
* <span data-ttu-id="054ac-138">Dans `ConfigureServices`:`IServiceCollection`</span><span class="sxs-lookup"><span data-stu-id="054ac-138">In `ConfigureServices`:  `IServiceCollection`</span></span>
* <span data-ttu-id="054ac-139">Dans `Configure`: `IApplicationBuilder`, `IHostingEnvironment`,`ILoggerFactory`</span><span class="sxs-lookup"><span data-stu-id="054ac-139">In `Configure`:  `IApplicationBuilder`, `IHostingEnvironment`, `ILoggerFactory`</span></span>

<span data-ttu-id="054ac-140">Tous les services ajoutés par le ``WebHostBuilder`` ``ConfigureServices`` méthode peut être demandée par le ``Startup`` constructeur de classe ou son ``Configure`` (méthode).</span><span class="sxs-lookup"><span data-stu-id="054ac-140">Any services added by the ``WebHostBuilder`` ``ConfigureServices`` method may be requested by the ``Startup`` class constructor or its ``Configure`` method.</span></span> <span data-ttu-id="054ac-141">Utilisez `WebHostBuilder` pour fournir les services que vous avez besoin au cours de `Startup` méthodes.</span><span class="sxs-lookup"><span data-stu-id="054ac-141">Use `WebHostBuilder` to provide any services you need during `Startup` methods.</span></span>

## <a name="the-configure-method"></a><span data-ttu-id="054ac-142">Méthode Configure</span><span class="sxs-lookup"><span data-stu-id="054ac-142">The Configure method</span></span>

<span data-ttu-id="054ac-143">Le `Configure` méthode est utilisée pour spécifier la façon dont l’application ASP.NET doit répondre aux demandes HTTP.</span><span class="sxs-lookup"><span data-stu-id="054ac-143">The `Configure` method is used to specify how the ASP.NET application will respond to HTTP requests.</span></span> <span data-ttu-id="054ac-144">Le pipeline de requête est configuré en ajoutant [intergiciel (middleware)](middleware.md) composants à une `IApplicationBuilder` instance qui est fournie par injection de dépendances.</span><span class="sxs-lookup"><span data-stu-id="054ac-144">The request pipeline is configured by adding [middleware](middleware.md) components to an `IApplicationBuilder` instance that is provided by dependency injection.</span></span>

<span data-ttu-id="054ac-145">Dans l’exemple suivant à partir du modèle de site web par défaut, plusieurs méthodes d’extension sont utilisés pour configurer le pipeline avec prise en charge pour [BrowserLink](http://vswebessentials.com/features/browserlink), pages d’erreurs, les fichiers statiques, ASP.NET MVC et identité.</span><span class="sxs-lookup"><span data-stu-id="054ac-145">In the following example from the default web site template, several extension methods are used to configure the pipeline with support for [BrowserLink](http://vswebessentials.com/features/browserlink), error pages, static files, ASP.NET MVC, and Identity.</span></span>

<span data-ttu-id="054ac-146">[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=8,9,10,14,17,19,21&start=58&end=84)]</span><span class="sxs-lookup"><span data-stu-id="054ac-146">[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=8,9,10,14,17,19,21&start=58&end=84)]</span></span>

<span data-ttu-id="054ac-147">Chaque `Use` méthode d’extension ajoute un [intergiciel (middleware)](xref:fundamentals/middleware) composant au pipeline de demande.</span><span class="sxs-lookup"><span data-stu-id="054ac-147">Each `Use` extension method adds a [middleware](xref:fundamentals/middleware) component to the request pipeline.</span></span> <span data-ttu-id="054ac-148">Par exemple, le `UseMvc` ajoute de la méthode d’extension du [routage](routing.md) intergiciel (middleware) au pipeline de demande et configure [MVC](xref:mvc/overview) en tant que gestionnaire par défaut.</span><span class="sxs-lookup"><span data-stu-id="054ac-148">For instance, the `UseMvc` extension method adds the [routing](routing.md) middleware to the request pipeline and configures [MVC](xref:mvc/overview) as the default handler.</span></span>

<span data-ttu-id="054ac-149">Pour plus d’informations sur l’utilisation de `IApplicationBuilder`, consultez [intergiciel (middleware)](xref:fundamentals/middleware).</span><span class="sxs-lookup"><span data-stu-id="054ac-149">For more information about how to use `IApplicationBuilder`, see [Middleware](xref:fundamentals/middleware).</span></span>

<span data-ttu-id="054ac-150">Services supplémentaires, telles que `IHostingEnvironment` et `ILoggerFactory` peut également être spécifié dans la signature de méthode, auquel cas ces services seront [injecté](dependency-injection.md) si elles sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="054ac-150">Additional services, like `IHostingEnvironment` and `ILoggerFactory` may also be specified in the method signature, in which case these services will be [injected](dependency-injection.md) if they are available.</span></span> 

## <a name="additional-resources"></a><span data-ttu-id="054ac-151">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="054ac-151">Additional Resources</span></span>

* [<span data-ttu-id="054ac-152">Utilisation de plusieurs environnements</span><span class="sxs-lookup"><span data-stu-id="054ac-152">Working with Multiple Environments</span></span>](xref:fundamentals/environments)
* [<span data-ttu-id="054ac-153">Intergiciel (middleware)</span><span class="sxs-lookup"><span data-stu-id="054ac-153">Middleware</span></span>](xref:fundamentals/middleware)
* [<span data-ttu-id="054ac-154">Journalisation</span><span class="sxs-lookup"><span data-stu-id="054ac-154">Logging</span></span>](xref:fundamentals/logging)
* [<span data-ttu-id="054ac-155">Configuration</span><span class="sxs-lookup"><span data-stu-id="054ac-155">Configuration</span></span>](xref:fundamentals/configuration)
