---
title: "Utilisation du modèle d’Application"
author: ardalis
description: 
keywords: "Modèle d’application ASP.NET Core, ASP.NET MVC de base,"
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.assetid: 4eb7e52f-5665-41a4-a3e3-e348d07337f2
ms.technology: aspnet
ms.prod: asp.net-core
uid: mvc/controllers/application-model
ms.openlocfilehash: 1a5d461809afeef0f485fd3a665250631d855b36
ms.sourcegitcommit: 9cdbfd0d670d70b9c354216aabee260c52dad5ee
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/12/2017
---
# <a name="working-with-the-application-model"></a><span data-ttu-id="9662c-103">Utilisation du modèle d’Application</span><span class="sxs-lookup"><span data-stu-id="9662c-103">Working with the Application Model</span></span>

<span data-ttu-id="9662c-104">Par [Steve Smith](https://ardalis.com/)</span><span class="sxs-lookup"><span data-stu-id="9662c-104">By [Steve Smith](https://ardalis.com/)</span></span>

<span data-ttu-id="9662c-105">ASP.NET MVC de base définit un *modèle d’application* représentant les composants d’une application MVC.</span><span class="sxs-lookup"><span data-stu-id="9662c-105">ASP.NET Core MVC defines an *application model* representing the components of an MVC app.</span></span> <span data-ttu-id="9662c-106">Vous pouvez lire et manipuler ce modèle pour modifier le comportement des éléments MVC.</span><span class="sxs-lookup"><span data-stu-id="9662c-106">You can read and manipulate this model to modify how MVC elements behave.</span></span> <span data-ttu-id="9662c-107">Par défaut, MVC suit certaines conventions pour déterminer les classes qui sont considérés comme étant des contrôleurs, les méthodes sur ces classes sont des actions et le comportement des paramètres et le routage.</span><span class="sxs-lookup"><span data-stu-id="9662c-107">By default, MVC follows certain conventions to determine which classes are considered to be controllers, which methods on those classes are actions, and how parameters and routing behave.</span></span> <span data-ttu-id="9662c-108">Vous pouvez personnaliser ce comportement en fonction des besoins de votre application en créant vos propres conventions et de les appliquer globalement ou en tant qu’attributs.</span><span class="sxs-lookup"><span data-stu-id="9662c-108">You can customize this behavior to suit your app's needs by creating your own conventions and applying them globally or as attributes.</span></span>

## <a name="models-and-providers"></a><span data-ttu-id="9662c-109">Les modèles et les fournisseurs</span><span class="sxs-lookup"><span data-stu-id="9662c-109">Models and Providers</span></span>

<span data-ttu-id="9662c-110">Le modèle d’application ASP.NET MVC de base incluent les interfaces abstraites et les classes d’implémentation concrète qui décrivent une application MVC.</span><span class="sxs-lookup"><span data-stu-id="9662c-110">The ASP.NET Core MVC application model include both abstract interfaces and concrete implementation classes that describe an MVC application.</span></span> <span data-ttu-id="9662c-111">Ce modèle est le résultat de MVC, découverte des contrôleurs, actions, paramètres d’action, itinéraires et filtres selon les conventions de la valeur par défaut de l’application.</span><span class="sxs-lookup"><span data-stu-id="9662c-111">This model is the result of MVC discovering the app's controllers, actions, action parameters, routes, and filters according to default conventions.</span></span> <span data-ttu-id="9662c-112">En travaillant avec le modèle d’application, vous pouvez modifier votre application pour suivre les conventions différentes du comportement de MVC par défaut.</span><span class="sxs-lookup"><span data-stu-id="9662c-112">By working with the application model, you can modify your app to follow different conventions from the default MVC behavior.</span></span> <span data-ttu-id="9662c-113">Les paramètres, les noms, les itinéraires et les filtres sont utilisés comme données de configuration pour les actions et les contrôleurs de.</span><span class="sxs-lookup"><span data-stu-id="9662c-113">The parameters, names, routes, and filters are all used as configuration data for actions and controllers.</span></span>

<span data-ttu-id="9662c-114">Le modèle d’Application MVC ASP.NET Core a la structure suivante :</span><span class="sxs-lookup"><span data-stu-id="9662c-114">The ASP.NET Core MVC Application Model has the following structure:</span></span>

* <span data-ttu-id="9662c-115">ApplicationModel</span><span class="sxs-lookup"><span data-stu-id="9662c-115">ApplicationModel</span></span>
    * <span data-ttu-id="9662c-116">Contrôleurs (ControllerModel)</span><span class="sxs-lookup"><span data-stu-id="9662c-116">Controllers (ControllerModel)</span></span>
        * <span data-ttu-id="9662c-117">Actions (ActionModel)</span><span class="sxs-lookup"><span data-stu-id="9662c-117">Actions (ActionModel)</span></span>
            * <span data-ttu-id="9662c-118">Paramètres (ParameterModel)</span><span class="sxs-lookup"><span data-stu-id="9662c-118">Parameters (ParameterModel)</span></span>

<span data-ttu-id="9662c-119">Chaque niveau du modèle a accès à un commun `Properties` collection et les niveaux inférieurs peuvent accéder et remplacer les valeurs de propriété définies par les niveaux supérieurs de la hiérarchie.</span><span class="sxs-lookup"><span data-stu-id="9662c-119">Each level of the model has access to a common `Properties` collection, and lower levels can access and overwrite property values set by higher levels in the hierarchy.</span></span> <span data-ttu-id="9662c-120">Les propriétés sont rendues persistantes dans le `ActionDescriptor.Properties` lorsque les actions sont créées.</span><span class="sxs-lookup"><span data-stu-id="9662c-120">The properties are persisted to the `ActionDescriptor.Properties` when the actions are created.</span></span> <span data-ttu-id="9662c-121">Puis lorsqu’une demande est traitée, toutes les propriétés une convention ajoutée ou modifiée est accessible via `ActionContext.ActionDescriptor.Properties`.</span><span class="sxs-lookup"><span data-stu-id="9662c-121">Then when a request is being handled, any properties a convention added or modified can be accessed through `ActionContext.ActionDescriptor.Properties`.</span></span> <span data-ttu-id="9662c-122">À l’aide de propriétés est un excellent moyen de configurer vos filtres et les classeurs de modèles, à la fois par action.</span><span class="sxs-lookup"><span data-stu-id="9662c-122">Using properties is a great way to configure your filters, model binders, etc. on a per-action basis.</span></span>

> [!NOTE]
> <span data-ttu-id="9662c-123">Le `ActionDescriptor.Properties` collection n’est pas thread-safe (pour les écritures) une fois que le démarrage de l’application a terminé.</span><span class="sxs-lookup"><span data-stu-id="9662c-123">The `ActionDescriptor.Properties` collection is not thread safe (for writes) once app startup has finished.</span></span> <span data-ttu-id="9662c-124">Les conventions sont la meilleure façon d’ajouter en toute sécurité des données à cette collection.</span><span class="sxs-lookup"><span data-stu-id="9662c-124">Conventions are the best way to safely add data to this collection.</span></span>

### <a name="iapplicationmodelprovider"></a><span data-ttu-id="9662c-125">IApplicationModelProvider</span><span class="sxs-lookup"><span data-stu-id="9662c-125">IApplicationModelProvider</span></span>

<span data-ttu-id="9662c-126">Cœur d’ASP.NET MVC charge le modèle d’application à l’aide d’un modèle de fournisseur, défini par le [IApplicationModelProvider](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iapplicationmodelprovider) interface.</span><span class="sxs-lookup"><span data-stu-id="9662c-126">ASP.NET Core MVC loads the application model using a provider pattern, defined by the [IApplicationModelProvider](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iapplicationmodelprovider) interface.</span></span> <span data-ttu-id="9662c-127">Cette section aborde certains aspects de l’implémentation interne de la façon de fonctions de ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="9662c-127">This section covers some of the internal implementation details of how this provider functions.</span></span> <span data-ttu-id="9662c-128">Il s’agit d’une rubrique avancée : la plupart des applications qui tirent parti du modèle d’application doit se faire en utilisant des conventions.</span><span class="sxs-lookup"><span data-stu-id="9662c-128">This is an advanced topic - most apps that leverage the application model should do so by working with conventions.</span></span>

<span data-ttu-id="9662c-129">Les implémentations de la `IApplicationModelProvider` interface « encapsuler », avec chaque appel de l’implémentation `OnProvidersExecuting` dans l’ordre croissant selon son `Order` propriété.</span><span class="sxs-lookup"><span data-stu-id="9662c-129">Implementations of the `IApplicationModelProvider` interface "wrap" one another, with each implementation calling `OnProvidersExecuting` in ascending order based on its `Order` property.</span></span> <span data-ttu-id="9662c-130">Le `OnProvidersExecuted` méthode est ensuite appelée dans l’ordre inverse.</span><span class="sxs-lookup"><span data-stu-id="9662c-130">The `OnProvidersExecuted` method is then called in reverse order.</span></span> <span data-ttu-id="9662c-131">Le framework définit plusieurs fournisseurs :</span><span class="sxs-lookup"><span data-stu-id="9662c-131">The framework defines several providers:</span></span>

<span data-ttu-id="9662c-132">Premier (`Order=-1000`) :</span><span class="sxs-lookup"><span data-stu-id="9662c-132">First (`Order=-1000`):</span></span>

* [`DefaultApplicationModelProvider`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.internal.defaultapplicationmodelprovider)

<span data-ttu-id="9662c-133">Puis (`Order=-990`) :</span><span class="sxs-lookup"><span data-stu-id="9662c-133">Then (`Order=-990`):</span></span>

* [`AuthorizationApplicationModelProvider`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.internal.authorizationapplicationmodelprovider)
* [`CorsApplicationModelProvider`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.cors.internal.corsapplicationmodelprovider)

> [!NOTE]
> <span data-ttu-id="9662c-134">L’ordre dans les deux fournisseurs avec la même valeur pour `Order` sont appelés n’est pas défini et par conséquent pas être sur.</span><span class="sxs-lookup"><span data-stu-id="9662c-134">The order in which two providers with the same value for `Order` are called is undefined, and therefore should not be relied upon.</span></span>

> [!NOTE]
> <span data-ttu-id="9662c-135">`IApplicationModelProvider`est un concept avancé pour les auteurs d’infrastructure à étendre.</span><span class="sxs-lookup"><span data-stu-id="9662c-135">`IApplicationModelProvider` is an advanced concept for framework authors to extend.</span></span> <span data-ttu-id="9662c-136">En général, les applications doivent utiliser les conventions et infrastructures utilisent des fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="9662c-136">In general, apps should use conventions and frameworks should use providers.</span></span> <span data-ttu-id="9662c-137">La principale différence est que les fournisseurs s’exécutent toujours avant les conventions.</span><span class="sxs-lookup"><span data-stu-id="9662c-137">The key distinction is that providers always run before conventions.</span></span>

<span data-ttu-id="9662c-138">Le `DefaultApplicationModelProvider` établit la plupart des comportements par défaut utilisés par ASP.NET MVC de base.</span><span class="sxs-lookup"><span data-stu-id="9662c-138">The `DefaultApplicationModelProvider` establishes many of the default behaviors used by ASP.NET Core MVC.</span></span> <span data-ttu-id="9662c-139">Ses responsabilités sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="9662c-139">Its responsibilities include:</span></span>

* <span data-ttu-id="9662c-140">Ajout de filtres globaux au contexte</span><span class="sxs-lookup"><span data-stu-id="9662c-140">Adding global filters to the context</span></span>
* <span data-ttu-id="9662c-141">Ajout de contrôleurs dans le contexte</span><span class="sxs-lookup"><span data-stu-id="9662c-141">Adding controllers to the context</span></span>
* <span data-ttu-id="9662c-142">Ajout de méthodes publiques de contrôleur en tant qu’actions</span><span class="sxs-lookup"><span data-stu-id="9662c-142">Adding public controller methods as actions</span></span>
* <span data-ttu-id="9662c-143">Ajout de paramètres de méthode d’action au contexte</span><span class="sxs-lookup"><span data-stu-id="9662c-143">Adding action method parameters to the context</span></span>
* <span data-ttu-id="9662c-144">Application de routage et autres attributs</span><span class="sxs-lookup"><span data-stu-id="9662c-144">Applying route and other attributes</span></span>

<span data-ttu-id="9662c-145">Certains comportements intégrés sont implémentées par le `DefaultApplicationModelProvider`.</span><span class="sxs-lookup"><span data-stu-id="9662c-145">Some built-in behaviors are implemented by the `DefaultApplicationModelProvider`.</span></span> <span data-ttu-id="9662c-146">Ce fournisseur est responsable de la construction de la [ `ControllerModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.controllermodel), qui à son tour fait référence à [ `ActionModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.actionmodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ActionModel), [ `PropertyModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.propertymodel), et [ `ParameterModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.parametermodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ParameterModel) instances.</span><span class="sxs-lookup"><span data-stu-id="9662c-146">This provider is responsible for constructing the [`ControllerModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.controllermodel), which in turn references [`ActionModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.actionmodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ActionModel), [`PropertyModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.propertymodel), and [`ParameterModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.parametermodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ParameterModel) instances.</span></span> <span data-ttu-id="9662c-147">La `DefaultApplicationModelProvider` classe est un détail d’implémentation interne de framework qui peuvent et ne changera à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="9662c-147">The `DefaultApplicationModelProvider` class is an internal framework implementation detail that can and will change in the future.</span></span> 

<span data-ttu-id="9662c-148">Le `AuthorizationApplicationModelProvider` est chargé d’appliquer le comportement associé à la `AuthorizeFilter` et `AllowAnonymousFilter` attributs.</span><span class="sxs-lookup"><span data-stu-id="9662c-148">The `AuthorizationApplicationModelProvider` is responsible for applying the behavior associated with the `AuthorizeFilter` and `AllowAnonymousFilter` attributes.</span></span> <span data-ttu-id="9662c-149">[En savoir plus sur ces attributs](xref:security/authorization/simple).</span><span class="sxs-lookup"><span data-stu-id="9662c-149">[Learn more about these attributes](xref:security/authorization/simple).</span></span>

<span data-ttu-id="9662c-150">Le `CorsApplicationModelProvider` implémente le comportement associé à la `IEnableCorsAttribute` et `IDisableCorsAttribute`et le `DisableCorsAuthorizationFilter`.</span><span class="sxs-lookup"><span data-stu-id="9662c-150">The `CorsApplicationModelProvider` implements behavior associated with the `IEnableCorsAttribute` and `IDisableCorsAttribute`, and the `DisableCorsAuthorizationFilter`.</span></span> <span data-ttu-id="9662c-151">[En savoir plus sur les règles CORS](xref:security/cors).</span><span class="sxs-lookup"><span data-stu-id="9662c-151">[Learn more about CORS](xref:security/cors).</span></span>

## <a name="conventions"></a><span data-ttu-id="9662c-152">Conventions</span><span class="sxs-lookup"><span data-stu-id="9662c-152">Conventions</span></span>

<span data-ttu-id="9662c-153">Le modèle d’application définit les abstractions de convention qui fournissent un moyen plus simple pour personnaliser le comportement des modèles de substitution de l’ensemble du modèle ou le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="9662c-153">The application model defines convention abstractions that provide a simpler way to customize the behavior of the models than overriding the entire model or provider.</span></span> <span data-ttu-id="9662c-154">Ces abstractions sont la méthode recommandée pour modifier le comportement de votre application.</span><span class="sxs-lookup"><span data-stu-id="9662c-154">These abstractions are the recommended way to modify your app's behavior.</span></span> <span data-ttu-id="9662c-155">Conventions permettent de vous permet d’écrire du code qui s’appliquent dynamiquement les personnalisations.</span><span class="sxs-lookup"><span data-stu-id="9662c-155">Conventions provide a way for you to write code that will dynamically apply customizations.</span></span> <span data-ttu-id="9662c-156">Alors que [filtres](xref:mvc/controllers/filters) fournissent un moyen de la modification de comportement de l’infrastructure, les personnalisations vous permettent de contrôler la façon dont l’application entière est reliée entre elles.</span><span class="sxs-lookup"><span data-stu-id="9662c-156">While [filters](xref:mvc/controllers/filters) provide a means of modifying the framework's behavior, customizations let you control how the whole app is wired together.</span></span>

<span data-ttu-id="9662c-157">Les conventions suivantes sont disponibles :</span><span class="sxs-lookup"><span data-stu-id="9662c-157">The following conventions are available:</span></span>

* [`IApplicationModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iapplicationmodelconvention)
* [`IControllerModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.icontrollermodelconvention)
* [`IActionModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iactionmodelconvention)
* [`IParameterModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iparametermodelconvention)

<span data-ttu-id="9662c-158">Les conventions sont appliquées en les ajoutant aux options de MVC ou en implémentant `Attribute`s et les appliquer aux contrôleurs, les actions ou les paramètres d’action (semblable à [ `Filters` ](xref:mvc/controllers/filters)).</span><span class="sxs-lookup"><span data-stu-id="9662c-158">Conventions are applied by adding them to MVC options or by implementing `Attribute`s and applying them to controllers, actions, or action parameters (similar to [`Filters`](xref:mvc/controllers/filters)).</span></span> <span data-ttu-id="9662c-159">Contrairement aux filtres, les conventions sont uniquement exécutées lors du démarrage de l’application, pas dans le cadre de chaque demande.</span><span class="sxs-lookup"><span data-stu-id="9662c-159">Unlike filters, conventions are only executed when the app is starting, not as part of each request.</span></span>

### <a name="sample-modifying-the-applicationmodel"></a><span data-ttu-id="9662c-160">Exemple : Modification de la ApplicationModel</span><span class="sxs-lookup"><span data-stu-id="9662c-160">Sample: Modifying the ApplicationModel</span></span>

<span data-ttu-id="9662c-161">La convention suivante permet d’ajouter une propriété au modèle d’application.</span><span class="sxs-lookup"><span data-stu-id="9662c-161">The following convention is used to add a property to the application model.</span></span> 

<span data-ttu-id="9662c-162">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ApplicationDescription.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-162">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ApplicationDescription.cs)]</span></span>

<span data-ttu-id="9662c-163">Conventions de modèle d’application sont appliquées en tant qu’options lors de l’ajout dans MVC `ConfigureServices` dans `Startup`.</span><span class="sxs-lookup"><span data-stu-id="9662c-163">Application model conventions are applied as options when MVC is added in `ConfigureServices` in `Startup`.</span></span>

<span data-ttu-id="9662c-164">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=5)]</span><span class="sxs-lookup"><span data-stu-id="9662c-164">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=5)]</span></span>

<span data-ttu-id="9662c-165">Les propriétés sont accessibles à partir de la `ActionDescriptor` collection de propriétés dans les actions de contrôleur :</span><span class="sxs-lookup"><span data-stu-id="9662c-165">Properties are accessible from the `ActionDescriptor` properties collection within controller actions:</span></span>

<span data-ttu-id="9662c-166">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/AppModelController.cs?name=AppModelController)]</span><span class="sxs-lookup"><span data-stu-id="9662c-166">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/AppModelController.cs?name=AppModelController)]</span></span>

### <a name="sample-modifying-the-controllermodel-description"></a><span data-ttu-id="9662c-167">Exemple : Modification de la Description de ControllerModel</span><span class="sxs-lookup"><span data-stu-id="9662c-167">Sample: Modifying the ControllerModel Description</span></span>

<span data-ttu-id="9662c-168">Comme dans l’exemple précédent, le modèle de contrôleur peut également être modifié pour inclure des propriétés personnalisées.</span><span class="sxs-lookup"><span data-stu-id="9662c-168">As in the previous example, the controller model can also be modified to include custom properties.</span></span> <span data-ttu-id="9662c-169">Ceux-ci remplacent les propriétés existantes portant le même nom que celui spécifié dans le modèle d’application.</span><span class="sxs-lookup"><span data-stu-id="9662c-169">These will override existing properties with the same name specified in the application model.</span></span> <span data-ttu-id="9662c-170">L’attribut de convention suivant ajoute une description au niveau du contrôleur :</span><span class="sxs-lookup"><span data-stu-id="9662c-170">The following convention attribute adds a description at the controller level:</span></span>

<span data-ttu-id="9662c-171">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ControllerDescriptionAttribute.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-171">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ControllerDescriptionAttribute.cs)]</span></span>

<span data-ttu-id="9662c-172">Cette convention est appliquée en tant qu’attribut sur un contrôleur.</span><span class="sxs-lookup"><span data-stu-id="9662c-172">This convention is applied as an attribute on a controller.</span></span>

<span data-ttu-id="9662c-173">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=ControllerDescription&highlight=1)]</span><span class="sxs-lookup"><span data-stu-id="9662c-173">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=ControllerDescription&highlight=1)]</span></span>

<span data-ttu-id="9662c-174">Accède à la propriété « description » de la même manière que dans les exemples précédents.</span><span class="sxs-lookup"><span data-stu-id="9662c-174">The "description" property is accessed in the same manner as in previous examples.</span></span>

### <a name="sample-modifying-the-actionmodel-description"></a><span data-ttu-id="9662c-175">Exemple : Modification de la Description de ActionModel</span><span class="sxs-lookup"><span data-stu-id="9662c-175">Sample: Modifying the ActionModel Description</span></span>

<span data-ttu-id="9662c-176">Une convention d’attribut distinct peut être appliquée aux actions individuelles, substituer le comportement déjà appliqué au niveau du contrôleur ou d’application.</span><span class="sxs-lookup"><span data-stu-id="9662c-176">A separate attribute convention can be applied to individual actions, overriding behavior already applied at the application or controller level.</span></span>

<span data-ttu-id="9662c-177">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ActionDescriptionAttribute.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-177">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ActionDescriptionAttribute.cs)]</span></span>

<span data-ttu-id="9662c-178">Cette application à une action dans le contrôleur de l’exemple précédent montre comment elle substitue à la convention de niveau contrôleur :</span><span class="sxs-lookup"><span data-stu-id="9662c-178">Applying this to an action within the previous example's controller demonstrates how it overrides the controller-level convention:</span></span>

<span data-ttu-id="9662c-179">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=DescriptionAttributesController&highlight=9)]</span><span class="sxs-lookup"><span data-stu-id="9662c-179">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=DescriptionAttributesController&highlight=9)]</span></span>

### <a name="sample-modifying-the-parametermodel"></a><span data-ttu-id="9662c-180">Exemple : Modification de la ParameterModel</span><span class="sxs-lookup"><span data-stu-id="9662c-180">Sample: Modifying the ParameterModel</span></span>

<span data-ttu-id="9662c-181">La convention suivante peut être appliquée aux paramètres d’action pour modifier leur `BindingInfo`.</span><span class="sxs-lookup"><span data-stu-id="9662c-181">The following convention can be applied to action parameters to modify their `BindingInfo`.</span></span> <span data-ttu-id="9662c-182">La convention suivante requiert que le paramètre soit un paramètre d’itinéraire ; autres sources potentielles de la liaison (par exemple, les valeurs de chaîne de requête) sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="9662c-182">The following convention requires that the parameter be a route parameter; other potential binding sources (such as query string values) are ignored.</span></span>

<span data-ttu-id="9662c-183">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/MustBeInRouteParameterModelConvention.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-183">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/MustBeInRouteParameterModelConvention.cs)]</span></span>

<span data-ttu-id="9662c-184">L’attribut peut être appliqué à n’importe quel paramètre d’action :</span><span class="sxs-lookup"><span data-stu-id="9662c-184">The attribute may be applied to any action parameter:</span></span>

<span data-ttu-id="9662c-185">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/ParameterModelController.cs?name=ParameterModelController&highlight=5)]</span><span class="sxs-lookup"><span data-stu-id="9662c-185">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/ParameterModelController.cs?name=ParameterModelController&highlight=5)]</span></span>

### <a name="sample-modifying-the-actionmodel-name"></a><span data-ttu-id="9662c-186">Exemple : Modification du nom de ActionModel</span><span class="sxs-lookup"><span data-stu-id="9662c-186">Sample: Modifying the ActionModel Name</span></span>

<span data-ttu-id="9662c-187">La convention suivante modifie le `ActionModel` pour mettre à jour le *nom* de l’action à laquelle elle est appliquée.</span><span class="sxs-lookup"><span data-stu-id="9662c-187">The following convention modifies the `ActionModel` to update the *name* of the action to which it is applied.</span></span> <span data-ttu-id="9662c-188">Le nouveau nom est fourni en tant que paramètre à l’attribut.</span><span class="sxs-lookup"><span data-stu-id="9662c-188">The new name is provided as a parameter to the attribute.</span></span> <span data-ttu-id="9662c-189">Ce nouveau nom est utilisé par le routage, afin qu’il affecte l’itinéraire utilisé pour accéder à cette méthode d’action.</span><span class="sxs-lookup"><span data-stu-id="9662c-189">This new name is used by routing, so it will affect the route used to reach this action method.</span></span>

<span data-ttu-id="9662c-190">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/CustomActionNameAttribute.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-190">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/CustomActionNameAttribute.cs)]</span></span>

<span data-ttu-id="9662c-191">Cet attribut est appliqué à une méthode d’action dans le `HomeController`:</span><span class="sxs-lookup"><span data-stu-id="9662c-191">This attribute is applied to an action method in the `HomeController`:</span></span>

<span data-ttu-id="9662c-192">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/HomeController.cs?name=ActionModelConvention&highlight=2)]</span><span class="sxs-lookup"><span data-stu-id="9662c-192">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/HomeController.cs?name=ActionModelConvention&highlight=2)]</span></span>

<span data-ttu-id="9662c-193">Même si le nom de la méthode est `SomeName`, l’attribut se substitue à la convention MVC d’en utilisant le nom de méthode et remplace le nom de l’action avec `MyCoolAction`.</span><span class="sxs-lookup"><span data-stu-id="9662c-193">Even though the method name is `SomeName`, the attribute overrides the MVC convention of using the method name and replaces the action name with `MyCoolAction`.</span></span> <span data-ttu-id="9662c-194">Par conséquent, l’itinéraire utilisé pour accéder à cette action est `/Home/MyCoolAction`.</span><span class="sxs-lookup"><span data-stu-id="9662c-194">Thus, the route used to reach this action is `/Home/MyCoolAction`.</span></span>

> [!NOTE]
> <span data-ttu-id="9662c-195">Cet exemple est essentiellement identique à l’aide de la fonction intégrée [ActionName](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.actionnameattribute) attribut.</span><span class="sxs-lookup"><span data-stu-id="9662c-195">This example is essentially the same as using the built-in [ActionName](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.actionnameattribute) attribute.</span></span>

### <a name="sample-custom-routing-convention"></a><span data-ttu-id="9662c-196">Exemple : Convention de routage personnalisé</span><span class="sxs-lookup"><span data-stu-id="9662c-196">Sample: Custom Routing Convention</span></span>

<span data-ttu-id="9662c-197">Vous pouvez utiliser un `IApplicationModelConvention` pour personnaliser le fonctionnement du routage.</span><span class="sxs-lookup"><span data-stu-id="9662c-197">You can use an `IApplicationModelConvention` to customize how routing works.</span></span> <span data-ttu-id="9662c-198">Par exemple, la convention suivante intègrent des espaces de noms de contrôleurs dans leurs routes, en remplaçant `.` dans l’espace de noms `/` dans l’itinéraire :</span><span class="sxs-lookup"><span data-stu-id="9662c-198">For example, the following convention will incorporate Controllers' namespaces into their routes, replacing `.` in the namespace with `/` in the route:</span></span>

<span data-ttu-id="9662c-199">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/NamespaceRoutingConvention.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-199">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/NamespaceRoutingConvention.cs)]</span></span>

<span data-ttu-id="9662c-200">La convention est ajoutée en tant qu’option de démarrage.</span><span class="sxs-lookup"><span data-stu-id="9662c-200">The convention is added as an option in Startup.</span></span>

<span data-ttu-id="9662c-201">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=6)]</span><span class="sxs-lookup"><span data-stu-id="9662c-201">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=6)]</span></span>

> [!TIP]
> <span data-ttu-id="9662c-202">Vous pouvez ajouter des conventions pour votre [intergiciel (middleware)](xref:fundamentals/middleware) en accédant à `MvcOptions` à l’aide de`services.Configure<MvcOptions>(c => c.Conventions.Add(YOURCONVENTION));`</span><span class="sxs-lookup"><span data-stu-id="9662c-202">You can add conventions to your [middleware](xref:fundamentals/middleware) by accessing `MvcOptions` using `services.Configure<MvcOptions>(c => c.Conventions.Add(YOURCONVENTION));`</span></span>

<span data-ttu-id="9662c-203">Cet exemple s’applique à cette convention pour les itinéraires qui n’utilisent pas l’attribut routage où le contrôleur a « Namespace » dans son nom.</span><span class="sxs-lookup"><span data-stu-id="9662c-203">This sample applies this convention to routes that are not using attribute routing where the controller has  "Namespace" in its name.</span></span> <span data-ttu-id="9662c-204">Le contrôleur suivant illustre cette convention :</span><span class="sxs-lookup"><span data-stu-id="9662c-204">The following controller demonstrates this convention:</span></span>

<span data-ttu-id="9662c-205">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/NamespaceRoutingController.cs?highlight=7-8)]</span><span class="sxs-lookup"><span data-stu-id="9662c-205">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/NamespaceRoutingController.cs?highlight=7-8)]</span></span>

## <a name="application-model-usage-in-webapicompatshim"></a><span data-ttu-id="9662c-206">Utilisation du modèle d’application dans WebApiCompatShim</span><span class="sxs-lookup"><span data-stu-id="9662c-206">Application Model Usage in WebApiCompatShim</span></span>

<span data-ttu-id="9662c-207">ASP.NET Core MVC utilise un autre ensemble de conventions d’ASP.NET Web API 2.</span><span class="sxs-lookup"><span data-stu-id="9662c-207">ASP.NET Core MVC uses a different set of conventions from ASP.NET Web API 2.</span></span> <span data-ttu-id="9662c-208">À l’aide des conventions personnalisées, vous pouvez modifier le comportement d’une application ASP.NET MVC de base pour être cohérent avec celui d’une application API Web.</span><span class="sxs-lookup"><span data-stu-id="9662c-208">Using custom conventions, you can modify an ASP.NET Core MVC app's behavior to be consistent with that of a Web API app.</span></span> <span data-ttu-id="9662c-209">Est fourni avec Microsoft le [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim/) spécialement dans ce but.</span><span class="sxs-lookup"><span data-stu-id="9662c-209">Microsoft ships the [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim/) specifically for this purpose.</span></span>

> [!NOTE]
> <span data-ttu-id="9662c-210">En savoir plus sur [migration à partir de l’API Web ASP.NET](xref:migration/webapi).</span><span class="sxs-lookup"><span data-stu-id="9662c-210">Learn more about [migrating from ASP.NET Web API](xref:migration/webapi).</span></span>

<span data-ttu-id="9662c-211">Pour utiliser le Shim de compatibilité d’API Web, vous devez ajouter le package à votre projet, puis ajouter les conventions pour MVC en appelant `AddWebApiConventions` dans `Startup`:</span><span class="sxs-lookup"><span data-stu-id="9662c-211">To use the Web API Compatibility Shim, you need to add the package to your project and then add the conventions to MVC by calling `AddWebApiConventions` in `Startup`:</span></span>

```c#
services.AddMvc().AddWebApiConventions();
```

<span data-ttu-id="9662c-212">Les conventions fournies par le shim sont appliquées uniquement à des parties de l’application ont été certains attributs appliqués.</span><span class="sxs-lookup"><span data-stu-id="9662c-212">The conventions provided by the shim are only applied to parts of the app that have had certain attributes applied to them.</span></span> <span data-ttu-id="9662c-213">Les quatre attributs suivants sont utilisés pour contrôler quels contrôleurs doivent avoir leurs conventions modifiées par les conventions de shim :</span><span class="sxs-lookup"><span data-stu-id="9662c-213">The following four attributes are used to control which controllers should have their conventions modified by the shim's conventions:</span></span>

* [<span data-ttu-id="9662c-214">UseWebApiActionConventionsAttribute</span><span class="sxs-lookup"><span data-stu-id="9662c-214">UseWebApiActionConventionsAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapiactionconventionsattribute)
* [<span data-ttu-id="9662c-215">UseWebApiOverloadingAttribute</span><span class="sxs-lookup"><span data-stu-id="9662c-215">UseWebApiOverloadingAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapioverloadingattribute)
* [<span data-ttu-id="9662c-216">UseWebApiParameterConventionsAttribute</span><span class="sxs-lookup"><span data-stu-id="9662c-216">UseWebApiParameterConventionsAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapiparameterconventionsattribute)
* [<span data-ttu-id="9662c-217">UseWebApiRoutesAttribute</span><span class="sxs-lookup"><span data-stu-id="9662c-217">UseWebApiRoutesAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapiroutesattribute)

### <a name="action-conventions"></a><span data-ttu-id="9662c-218">Conventions d’action</span><span class="sxs-lookup"><span data-stu-id="9662c-218">Action Conventions</span></span>

<span data-ttu-id="9662c-219">Le `UseWebApiActionConventionsAttribute` est utilisé pour mapper la méthode HTTP à des actions en fonction de leur nom (par exemple, `Get` mappe sur `HttpGet`).</span><span class="sxs-lookup"><span data-stu-id="9662c-219">The `UseWebApiActionConventionsAttribute` is used to map the HTTP method to actions based on their name (for instance, `Get` would map to `HttpGet`).</span></span> <span data-ttu-id="9662c-220">Il s’applique uniquement à des actions qui n’utilisent pas de routage d’attributs.</span><span class="sxs-lookup"><span data-stu-id="9662c-220">It only applies to actions that do not use attribute routing.</span></span>

### <a name="overloading"></a><span data-ttu-id="9662c-221">Surcharge</span><span class="sxs-lookup"><span data-stu-id="9662c-221">Overloading</span></span>

<span data-ttu-id="9662c-222">Le `UseWebApiOverloadingAttribute` est utilisé pour appliquer la `WebApiOverloadingApplicationModelConvention` convention.</span><span class="sxs-lookup"><span data-stu-id="9662c-222">The `UseWebApiOverloadingAttribute` is used to apply the `WebApiOverloadingApplicationModelConvention` convention.</span></span> <span data-ttu-id="9662c-223">Cette convention ajoute une `OverloadActionConstraint` au processus de sélection d’action, ce qui limite les actions de candidat à ceux pour lesquels la demande répond à tous les paramètres non facultatifs.</span><span class="sxs-lookup"><span data-stu-id="9662c-223">This convention adds an `OverloadActionConstraint` to the action selection process, which limits candidate actions to those for which the request satisfies all non-optional parameters.</span></span>

### <a name="parameter-conventions"></a><span data-ttu-id="9662c-224">Conventions de paramètre</span><span class="sxs-lookup"><span data-stu-id="9662c-224">Parameter Conventions</span></span>

<span data-ttu-id="9662c-225">Le `UseWebApiParameterConventionsAttribute` est utilisé pour appliquer la `WebApiParameterConventionsApplicationModelConvention` convention d’action.</span><span class="sxs-lookup"><span data-stu-id="9662c-225">The `UseWebApiParameterConventionsAttribute` is used to apply the `WebApiParameterConventionsApplicationModelConvention` action convention.</span></span> <span data-ttu-id="9662c-226">Cette convention Spécifie que les types simples utilisés comme paramètres d’action sont liés à partir de l’URI par défaut, alors que les types complexes sont liés à partir du corps de la demande.</span><span class="sxs-lookup"><span data-stu-id="9662c-226">This convention specifies that simple types used as action parameters are bound from the URI by default, while complex types are bound from the request body.</span></span>

### <a name="routes"></a><span data-ttu-id="9662c-227">Itinéraires</span><span class="sxs-lookup"><span data-stu-id="9662c-227">Routes</span></span>

<span data-ttu-id="9662c-228">Le `UseWebApiRoutesAttribute` contrôles si le `WebApiApplicationModelConvention` convention de contrôleur est appliquée.</span><span class="sxs-lookup"><span data-stu-id="9662c-228">The `UseWebApiRoutesAttribute` controls whether the `WebApiApplicationModelConvention` controller convention is applied.</span></span> <span data-ttu-id="9662c-229">Lorsque activé, cette convention est utilisée pour ajouter la prise en charge de [zones](xref:mvc/controllers/areas) vers l’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="9662c-229">When enabled, this convention is used to add support for [areas](xref:mvc/controllers/areas) to the route.</span></span>

<span data-ttu-id="9662c-230">En plus d’un ensemble de conventions, le package de compatibilité inclut un `System.Web.Http.ApiController` classe de base qui remplace celui fourni par l’API Web.</span><span class="sxs-lookup"><span data-stu-id="9662c-230">In addition to a set of conventions, the compatibility package includes a `System.Web.Http.ApiController` base class that replaces the one provided by Web API.</span></span> <span data-ttu-id="9662c-231">Ainsi, vos contrôleurs écrits pour API Web et l’héritage à partir de son `ApiController` fonctionne comme prévus, lors de l’exécution d’ASP.NET MVC de base.</span><span class="sxs-lookup"><span data-stu-id="9662c-231">This allows your controllers written for Web API and inheriting from its `ApiController` to work as they were designed, while running on ASP.NET Core MVC.</span></span> <span data-ttu-id="9662c-232">Cette classe de base de contrôleur est décorée avec tous les `UseWebApi*` attributs répertoriés ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="9662c-232">This base controller class is decorated with all of the `UseWebApi*` attributes listed above.</span></span> <span data-ttu-id="9662c-233">Le `ApiController` expose les propriétés, méthodes et types de résultats qui sont compatibles avec ceux de l’API Web.</span><span class="sxs-lookup"><span data-stu-id="9662c-233">The `ApiController` exposes properties, methods, and result types that are compatible with those found in Web API.</span></span>

## <a name="using-apiexplorer-to-document-your-app"></a><span data-ttu-id="9662c-234">À l’aide de ApiExplorer pour documenter votre application</span><span class="sxs-lookup"><span data-stu-id="9662c-234">Using ApiExplorer to Document Your App</span></span>

<span data-ttu-id="9662c-235">Le modèle d’application expose une [ `ApiExplorer` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.apiexplorermodel) propriété à chaque niveau qui peut être utilisé pour parcourir la structure de l’application.</span><span class="sxs-lookup"><span data-stu-id="9662c-235">The application model exposes an [`ApiExplorer`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.apiexplorermodel) property at each level that can be used to traverse the app's structure.</span></span> <span data-ttu-id="9662c-236">Cela peut être utilisé pour [générer des pages d’aide pour votre API Web à l’aide des outils tels que Swagger](https://docs.microsoft.com/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="9662c-236">This can be used to [generate help pages for your Web APIs using tools like Swagger](https://docs.microsoft.com/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span> <span data-ttu-id="9662c-237">Le `ApiExplorer` propriété expose un `IsVisible` propriété qui peut être définie pour spécifier les parties du modèle de votre application doivent être exposées.</span><span class="sxs-lookup"><span data-stu-id="9662c-237">The `ApiExplorer` property exposes an `IsVisible` property that can be set to specify which parts of your app's model should be exposed.</span></span> <span data-ttu-id="9662c-238">Vous pouvez configurer ce paramètre en utilisant une convention :</span><span class="sxs-lookup"><span data-stu-id="9662c-238">You can configure this setting using a convention:</span></span>

<span data-ttu-id="9662c-239">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/EnableApiExplorerApplicationConvention.cs)]</span><span class="sxs-lookup"><span data-stu-id="9662c-239">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/EnableApiExplorerApplicationConvention.cs)]</span></span>

<span data-ttu-id="9662c-240">À l’aide de cette approche (et des conventions supplémentaires si nécessaire), vous pouvez activer ou désactiver la visibilité des API n’importe quel niveau au sein de votre application.</span><span class="sxs-lookup"><span data-stu-id="9662c-240">Using this approach (and additional conventions if required), you can enable or disable API visibility at any level within your app.</span></span> 
